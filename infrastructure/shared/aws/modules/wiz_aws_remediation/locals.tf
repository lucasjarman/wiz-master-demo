locals {
  ecr_url = "${var.ImageAccountID}.dkr.ecr.${var.region}.amazonaws.com/${var.ImageNameTag}"
  tags = merge(
    var.WizRemediationTagValue,
    var.AdditionalTag
  )
  account_id = data.aws_caller_identity.current.account_id
  base_actions = [
    "autoscaling:CreateOrUpdateTags",
    "autoscaling:DescribeAutoScalingGroups",
    "autoscaling:UpdateAutoScalingGroup",
    "ec2:CreateSecurityGroup",
    "ec2:CreateSnapshot",
    "ec2:CreateTags",
    "ec2:DescribeIamInstanceProfileAssociations",
    "ec2:DescribeInstances",
    "ec2:DescribeSecurityGroupRules",
    "ec2:DescribeSecurityGroups",
    "ec2:DescribeSnapshotAttribute",
    "ec2:DescribeSnapshots",
    "ec2:DescribeVolumes",
    "ec2:DisassociateIamInstanceProfile",
    "ec2:ModifyInstanceMetadataOptions",
    "ec2:ModifyNetworkInterfaceAttribute",
    "ec2:ModifySnapshotAttribute",
    "ec2:ModifyVolume",
    "ec2:RebootInstances",
    "ec2:RevokeSecurityGroupEgress",
    "ec2:RevokeSecurityGroupIngress",
    "ec2:StopInstances",
    "ecs:DescribeServices",
    "ecs:DescribeTasks",
    "ecs:StopTask",
    "ecs:TagResource",
    "ecs:UpdateService",
    "elasticloadbalancing:AddTags",
    "elasticloadbalancing:DeregisterTargets",
    "elasticloadbalancing:DescribeTargetGroups",
    "elasticloadbalancing:DescribeTargetHealth",
    "iam:CreatePolicyVersion",
    "iam:GetAccessKeyLastUsed",
    "iam:ListAccessKeys",
    "iam:PutGroupPolicy",
    "iam:PutRolePolicy",
    "iam:PutUserPolicy",
    "iam:TagPolicy",
    "iam:TagRole",
    "iam:TagUser",
    "iam:UpdateAccessKey",
    "iam:UpdateAccountPasswordPolicy",
    "kms:CancelKeyDeletion",
    "kms:TagResource",
    "lambda:GetPolicy",
    "lambda:PutFunctionConcurrency",
    "lambda:RemovePermission",
    "lambda:TagResource",
    "rds:AddTagsToResource",
    "rds:DescribeDBClusterSnapshotAttributes",
    "rds:DescribeDBInstances",
    "rds:DescribeDBSnapshotAttributes",
    "rds:ModifyDBClusterSnapshotAttribute",
    "rds:ModifyDBInstance",
    "rds:ModifyDBSnapshotAttribute",
    "redshift:CreateTags",
    "redshift:DescribeClusters",
    "redshift:ModifyCluster",
    "s3:CreateBucket",
    "s3:GetBucketAcl",
    "s3:GetBucketLogging",
    "s3:GetBucketPolicy",
    "s3:GetBucketPublicAccessBlock",
    "s3:PutBucketAcl",
    "s3:PutBucketLogging",
    "s3:PutBucketPolicy",
    "s3:PutBucketPublicAccessBlock",
    "s3:PutBucketTagging",
    "s3:PutBucketVersioning",
    "s3:PutLifecycleConfiguration",
    "sts:GetCallerIdentity",
    "tag:TagResources"
  ]
  desructive_actions = [
    "ec2:DeleteSecurityGroup",
    "ec2:DeleteVolume",
    "ec2:TerminateInstances",
    "lambda:DeleteFunction",
    "s3:DeleteBucketPolicy"
  ]
}
